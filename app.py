import re, json
from fastapi import FastAPI
from pydantic import BaseModel

def extract_base_law(text: str):
    pattern = re.compile(
        r"Luật sửa đổi, bổ sung.*?của\s+(?P<name>.+?)\s+số\s+(?P<number>\d+\/\d+\/[A-Z0-9]+)",
        re.IGNORECASE
    )
    match = pattern.search(text)
    if not match:
        return None

    law_name = match.group("name").strip()
    law_number = match.group("number").strip()
    return str(law_name + " số " + law_number)

def extract_dieu_1(text: str):
    """
    Cắt toàn bộ Điều 1: từ 'Điều 1.' đến trước 'Điều 2.'
    """
    m = re.search(r"(Điều\s+1\..*?)(Điều\s+2\.|$)", text, re.DOTALL)
    return m.group(1).strip() if m else ""

def split_amendment_blocks(text: str):
    blocks = []
    current = []
    in_quote = False

    lines = text.split("\n")

    for line in lines:
        stripped = line.strip()

        # Nếu gặp đầu mục mới
        if re.match(r"\d+\.\s", stripped):
            # Nếu đang có block trước đó và:
            # - không ở trong ngoặc
            # - và (block trước là block sửa luật đã kết thúc
            #   HOẶC block trước không có ngoặc kép)
            if current and not in_quote:
                blocks.append("\n".join(current).strip())
                current = []

        # Kiểm tra vào ngoặc
        if "“" in stripped:
            in_quote = True

        current.append(line)

        # Kiểm tra thoát ngoặc
        if "”" in stripped:
            in_quote = False

    if current:
        blocks.append("\n".join(current).strip())

    return blocks

def parse_dieu_1_by_article(dieu_1_text: str):
    dieu_1_text = dieu_1_text.replace("\\n", "\n")

    blocks = split_amendment_blocks(dieu_1_text)
    results = []

    for block in blocks:
        block = block.strip()
        if not block:
            continue

        # 1. Lấy index đầu mục (số thứ tự sửa đổi)
        index_match = re.match(r"(\d+)\.\s", block)
        if not index_match:
            continue
        index = int(index_match.group(1))

        # 2. Xác định amendment_type
        if re.search(r"(bổ sung|thay thế|bỏ)\s+cụm\s+từ", block, re.IGNORECASE):
            amendment_type = "PHRASE_CHANGE"
        else:
            amendment_type = "LAW_CHANGE"

        # 3. Lấy Điều mục tiêu (nếu có)
        article_match = re.search(r"Điều\s+(\d+)", block)
        article = int(article_match.group(1)) if article_match else None

        results.append({
            "index": index,
            "article": article,
            "amendment_type": amendment_type,
            "block_text": block
        })

    return results

def process_amendment_document(text: str):
    """
    Output:
    {
      "original": "...",
      "addon": [ ... ]
    }
    """
    base_law = extract_base_law(text)

    dieu_1 = extract_dieu_1(text)

    amendments = parse_dieu_1_by_article(dieu_1)

    return {
        "original": base_law,
        "addon": amendments
    }


def main(text: str):
    res = process_amendment_document(text)
    # with open('output-3.json', 'w', encoding='utf-8') as f: # and output-6
    with open('output-8.json', 'w', encoding='utf-8') as f:
        json.dump(res, f, indent=4, ensure_ascii=False)
    f.close()


# text = "| QUỐC HỘI<br>------- | CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM<br>Độc lập - Tự do - Hạnh phúc <br>--------------- |\n| --- | --- |\n| Luật số: 99/2025/QH15 | Hà Nội, ngày 27 tháng 06 năm 2025 |\n\n \nLUẬT\nSỬA ĐỔI, BỔ SUNG MỘT SỐ ĐIỀU CỦA BỘ LUẬT TỐ TỤNG HÌNH SỰ\nCăn cứ Hiến pháp nước Cộng hòa xã hội chủ nghĩa Việt Nam đã được sửa đổi, bổ sung một số điều theo Nghị quyết số 203/2025/QH15;\nQuốc hội ban hành Luật sửa đổi, bổ sung một số điều của Bộ luật Tố tụng hình sự số 101/2015/QH13 đã được sửa đổi, bổ sung một số điều theo Luật số 02/2021/QH15, Luật số 34/2024/QH15 và Luật số 59/2024/QH15.\nĐiều 1. Sửa đổi, bổ sung một số điều của Bộ luật Tố tụng hình sự\n1. Bổ sung, bãi bỏ một số điểm của khoản 1 và khoản 2 Điều 4 như sau:\na) Bổ sung điểm p vào sau điểm o khoản 1 như sau:\n“p) Viện kiểm sát có thẩm quyền là Viện kiểm sát có trách nhiệm thực hành quyền công tố, kiểm sát việc tuân theo pháp luật trong giải quyết vụ việc, vụ án.”;\nb) Bổ sung điểm k vào sau điểm i khoản 2 như sau:\n“k) Xã, phường, đặc khu sau đây gọi là cấp xã.”;\nc) Bãi bỏ các điểm a, d và g khoản 2.\n2. Sửa đổi, bổ sung Điều 20 như sau:\n“Điều 20. Trách nhiệm thực hành quyền công tố và kiểm sát việc tuân theo pháp luật trong tố tụng hình sự\nViện kiểm sát thực hành quyền công tố và kiểm sát việc tuân theo pháp luật trong tố tụng hình sự, quyết định việc buộc tội, phát hiện vi phạm pháp luật nhằm bảo đảm mọi hành vi phạm tội, người phạm tội, pháp nhân phạm tội, vi phạm pháp luật đều phải được phát hiện và xử lý kịp thời, nghiêm minh, việc khởi tố, điều tra, truy tố, xét xử, thi hành án đúng người, đúng tội, đúng pháp luật, không để lọt tội phạm và người phạm tội, pháp nhân phạm tội, không làm oan người vô tội.\nViện trưởng Viện kiểm sát nhân dân tối cao quy định thẩm quyền của Viện kiểm sát nhân dân mỗi cấp trong thực hành quyền công tố và kiểm sát việc tuân theo pháp luật trong tố tụng hình sự theo quy định của Bộ luật này.”.\n3. Sửa đổi, bổ sung các điểm a, b, c, d, đ và e khoản 2 Điều 35 như sau:\n“a) Người được giao nhiệm vụ tiến hành một số hoạt động điều tra của Bộ đội biên phòng gồm Cục trưởng, Phó Cục trưởng Cục Trinh sát; Cục trưởng, Phó Cục trưởng Cục Phòng, chống ma túy và tội phạm; Đoàn trưởng, Phó Đoàn trưởng Đoàn Trinh sát; Đoàn trưởng, Phó Đoàn trưởng Đoàn Đặc nhiệm phòng, chống ma túy và tội phạm; Chỉ huy trưởng, Phó Chỉ huy trưởng Ban Chỉ huy Bộ đội biên phòng; Đồn trưởng, Phó Đồn trưởng Đồn biên phòng; Chỉ huy trưởng, Phó Chỉ huy trưởng Biên phòng Cửa khẩu cảng;\nb) Người được giao nhiệm vụ tiến hành một số hoạt động điều tra của Hải quan gồm Chi cục trưởng, Phó Chi cục trưởng Chi cục Điều tra chống buôn lậu; Chi cục trưởng, Phó Chi cục trưởng Chi cục kiểm tra sau thông quan; Chi cục trưởng, Phó Chi cục trưởng Chi cục Hải quan khu vực; Đội trưởng, Phó Đội trưởng Hải quan cửa khẩu;\nc) Người được giao nhiệm vụ tiến hành một số hoạt động điều tra của Kiểm lâm gồm Cục trưởng, Phó Cục trưởng Cục Lâm nghiệp và Kiểm lâm; Chi cục trưởng, Phó Chi cục trưởng Chi cục Kiểm lâm vùng, Chi cục trưởng, Phó Chi cục trưởng Chi cục Kiểm lâm; Hạt trưởng, Phó Hạt trưởng Hạt Kiểm lâm;\nd) Người được giao nhiệm vụ tiến hành một số hoạt động điều tra của lực lượng Cảnh sát biển gồm Tư lệnh, Phó Tư lệnh Cảnh sát biển; Tư lệnh vùng, Phó Tư lệnh vùng Cảnh sát biển; Cục trưởng, Phó Cục trưởng Cục Nghiệp vụ và pháp luật; Đoàn trưởng, Phó Đoàn trưởng Đoàn Trinh sát; Đoàn trưởng, Phó Đoàn trưởng Đoàn đặc nhiệm phòng, chống tội phạm ma túy; Hải đoàn trưởng, Phó Hải đoàn trưởng; Hải đội trưởng, Phó Hải đội trưởng; Đội trưởng, Phó Đội trưởng Đội nghiệp vụ Cảnh sát biển;\nđ) Người được giao nhiệm vụ tiến hành một số hoạt động điều tra của Kiểm ngư gồm Cục trưởng, Phó Cục trưởng Cục Thủy sản và Kiểm ngư; Chi cục trưởng, Phó Chi cục trưởng Chi cục Kiểm ngư vùng;\ne) Người được giao nhiệm vụ tiến hành một số hoạt động điều tra của các cơ quan khác trong Công an nhân dân gồm Cục trưởng, Phó Cục trưởng, Trưởng phòng, Phó Trưởng phòng các cơ quan được giao nhiệm vụ tiến hành một số hoạt động điều tra của Công an nhân dân, Giám thị, Phó Giám thị Trại giam theo quy định của Luật Tổ chức cơ quan điều tra hình sự;”.\n4. Sửa đổi, bổ sung khoản 4 Điều 36 như sau:\n“4. Thủ trưởng, Phó Thủ trưởng Cơ quan điều tra phải chịu trách nhiệm trước pháp luật về hành vi, quyết định của mình. Thủ trưởng, Phó Thủ trưởng Cơ quan điều tra không được ủy quyền cho Điều tra viên thực hiện nhiệm vụ, quyền hạn của mình, trừ trường hợp quy định tại khoản 1a Điều 37 của Bộ luật này.”.\n5. Bổ sung khoản 1a vào sau khoản 1 Điều 37 như sau:\n“1a. Điều tra viên trung cấp, Điều tra viên cao cấp là Trưởng Công an cấp xã hoặc Phó Trưởng Công an cấp xã được Thủ trưởng Cơ quan điều tra cấp tỉnh phân công tiến hành hoạt động khởi tố, điều tra vụ án về tội ít nghiêm trọng, tội nghiêm trọng xảy ra trên địa bàn cấp xã có nhiệm vụ, quyền hạn quy định tại khoản 1 Điều này, các điểm a, c khoản 1 và khoản 2 Điều 36 của Bộ luật này, trừ quyết định áp dụng, thay đổi, hủy bỏ biện pháp điều tra tố tụng đặc biệt.\nBộ trưởng Bộ Công an chủ trì, phối hợp với Viện trưởng Viện kiểm sát nhân dân tối cao quy định chi tiết khoản này.”.\n6. Sửa đổi, bổ sung khoản 4 và bổ sung khoản 5 vào sau khoản 4 Điều 41 như sau:\n“4. Viện trưởng, Phó Viện trưởng Viện kiểm sát phải chịu trách nhiệm trước pháp luật về hành vi, quyết định của mình. Viện trưởng, Phó Viện trưởng Viện kiểm sát không được ủy quyền cho Kiểm sát viên thực hiện nhiệm vụ, quyền hạn của mình, trừ trường hợp quy định tại khoản 5 Điều này.\n5. Trường hợp Viện Công tố và Kiểm sát xét xử phúc thẩm Viện kiểm sát nhân dân tối cao giải quyết vụ án thì Viện trưởng Viện kiểm sát nhân dân tối cao có thể ủy quyền cho Kiểm sát viên giữ chức vụ Viện trưởng, Phó Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm thực hiện nhiệm vụ, quyền hạn sau đây:\na) Nhiệm vụ, quyền hạn quy định tại điểm a khoản 1 và điểm p khoản 2 Điều này; kháng nghị theo thủ tục phúc thẩm bản án, quyết định của Tòa án theo quy định của Bộ luật này;\nb) Quyết định phân công hoặc thay đổi Phó Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm, Kiểm sát viên, Kiểm tra viên; kiểm tra hoạt động thực hành quyền công tố và kiểm sát việc tuân theo pháp luật của Phó Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm, Kiểm sát viên, Kiểm tra viên;\nc) Quyết định thay đổi hoặc hủy bỏ quyết định không có căn cứ và trái pháp luật của Phó Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm, Kiểm sát viên, Kiểm tra viên.”.\n7. Bổ sung khoản 1a vào sau khoản 1 Điều 42 như sau:\n“1a. Kiểm sát viên giữ chức vụ Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm Viện kiểm sát nhân dân tối cao có quyền giải quyết khiếu nại theo quy định của Bộ luật này.”.\n8. Sửa đổi, bổ sung khoản 4 và bổ sung khoản 5 vào sau khoản 4 Điều 44 như sau:\n“4. Chánh án, Phó Chánh án Tòa án phải chịu trách nhiệm trước pháp luật về hành vi, quyết định của mình. Chánh án, Phó Chánh án Tòa án không được ủy quyền cho Thẩm phán thực hiện nhiệm vụ, quyền hạn của mình, trừ trường hợp quy định tại khoản 5 Điều này.\n5. Trường hợp Tòa Phúc thẩm Tòa án nhân dân tối cao giải quyết vụ án thì Chánh án Tòa án nhân dân tối cao có thể ủy quyền cho Thẩm phán giữ chức vụ Chánh tòa, Phó Chánh tòa Tòa Phúc thẩm thực hiện nhiệm vụ, quyền hạn sau đây:\na) Trực tiếp tổ chức việc xét xử vụ án hình sự thuộc thẩm quyền;\nb) Nhiệm vụ, quyền hạn quy định tại điểm b khoản 2 Điều này;\nc) Quyết định phân công Phó Chánh tòa Tòa Phúc thẩm, Thẩm phán xét xử vụ án hình sự; quyết định phân công Thư ký Tòa án tiến hành tố tụng đối với vụ án hình sự; quyết định thay đổi Thẩm phán, Thư ký Tòa án trước khi mở phiên tòa.”.\n9. Bổ sung khoản 2a vào sau khoản 2 Điều 45 như sau:\n“2a. Thẩm phán giữ chức vụ Chánh tòa, Phó Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao có quyền áp dụng, thay đổi, hủy bỏ biện pháp tạm giam, xử lý vật chứng; Thẩm phán giữ chức vụ Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao có quyền giải quyết khiếu nại theo quy định của Bộ luật này.”.\n10. Sửa đổi, bổ sung khoản 4 Điều 75 như sau:\n“4. Người bị buộc tội, người đại diện hoặc người thân thích của họ đề nghị Ủy ban Mặt trận Tổ quốc Việt Nam và các tổ chức thành viên của Mặt trận cử bào chữa viên nhân dân để bào chữa cho người bị buộc tội là thành viên của tổ chức mình.”.\n11. Sửa đổi, bổ sung một số điểm, khoản của Điều 110 như sau:\na) Sửa đổi, bổ sung điểm a và điểm b khoản 2 như sau:\n“a) Thủ trưởng, Phó Thủ trưởng Cơ quan điều tra các cấp; Điều tra viên thuộc trường hợp quy định tại khoản 1a Điều 37 của Bộ luật này;\nb) Thủ trưởng đơn vị độc lập cấp trung đoàn và tương đương, Đồn trưởng Đồn biên phòng, Chỉ huy trưởng Biên phòng Cửa khẩu cảng, Chỉ huy trưởng Ban Chỉ huy Bộ đội biên phòng, Cục trưởng Cục Trinh sát Bộ đội biên phòng, Cục trưởng Cục phòng, chống ma túy và tội phạm Bộ đội biên phòng, Đoàn trưởng Đoàn đặc nhiệm phòng, chống ma túy và tội phạm Bộ đội biên phòng; Đoàn trưởng Đoàn Trinh sát Bộ đội biên phòng; Tư lệnh vùng lực lượng Cảnh sát biển, Cục trưởng Cục Nghiệp vụ và pháp luật lực lượng Cảnh sát biển, Đoàn trưởng Đoàn đặc nhiệm phòng, chống tội phạm ma túy lực lượng Cảnh sát biên, Đoàn trưởng Đoàn Trinh sát lực lượng Cảnh sát biển; Chi cục trưởng Chi cục Kiểm ngư vùng;”;\nb) Sửa đổi, bổ sung khoản 4 như sau:\n“4. Trong thời hạn 12 giờ kể từ khi giữ người trong trường hợp khẩn cấp hoặc nhận người bị giữ trong trường hợp khẩn cấp thì Cơ quan điều tra, cơ quan được giao nhiệm vụ tiến hành một số hoạt động điều tra phải lấy lời khai ngay và những người quy định tại điểm a và điểm b khoản 2 Điều này phải ra quyết định tạm giữ, ra lệnh bắt người bị giữ hoặc trả tự do ngay cho người đó. Lệnh bắt người bị giữ trong trường hợp khẩn cấp phải gửi ngay cho Viện kiểm sát có thẩm quyền kèm theo tài liệu liên quan đến việc giữ người để xét phê chuẩn.\nSau khi giữ người trong trường hợp khẩn cấp, những người quy định tại điểm c khoản 2 Điều này phải giải ngay người bị giữ kèm theo tài liệu liên quan đến việc giữ người trong trường hợp khẩn cấp đến Cơ quan điều tra nơi có sân bay hoặc bến cảng đầu tiên tàu trở về. Trong thời hạn 12 giờ kể từ khi tiếp nhận người bị giữ, Cơ quan điều tra phải lấy lời khai ngay và những người quy định tại điểm a khoản 2 Điều này phải ra quyết định tạm giữ, ra lệnh bắt người bị giữ trong trường hợp khẩn cấp hoặc trả tự do ngay cho người đó. Lệnh bắt người bị giữ trong trường hợp khẩn cấp phải gửi ngay cho Viện kiểm sát có thẩm quyền kèm theo tài liệu liên quan đến việc giữ người để xét phê chuẩn.\nLệnh bắt người bị giữ trong trường hợp khẩn cấp phải ghi rõ họ tên, địa chỉ của người bị giữ, lý do, căn cứ giữ người quy định tại khoản 1 Điều này và các nội dung quy định tại khoản 2 Điều 132 của Bộ luật này.”.\n12. Sửa đổi, bổ sung khoản 1 Điều 113 như sau:\n“1. Những người sau đây có quyền ra lệnh, quyết định bắt bị can, bị cáo để tạm giam:\na) Thủ trưởng, Phó Thủ trưởng Cơ quan điều tra các cấp; Điều tra viên thuộc trường hợp quy định tại khoản 1a Điều 37 của Bộ luật này. Trường hợp này, lệnh bắt phải được Viện kiểm sát có thẩm quyền phê chuẩn trước khi thi hành;\nb) Viện trưởng, Phó Viện trưởng Viện kiểm sát nhân dân và Viện trưởng, Phó Viện trưởng Viện kiểm sát quân sự các cấp;\nc) Chánh án, Phó Chánh án Tòa án nhân dân và Chánh án, Phó Chánh án Tòa án quân sự các cấp; Thẩm phán giữ chức vụ Chánh tòa, Phó Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao; Hội đồng xét xử.”.\n13. Bổ sung khoản 5 vào sau khoản 4 Điều 131 như sau:\n“5. Hồ sơ vụ án được lập bằng văn bản giấy hoặc được số hóa theo quy định.\nBộ trưởng Bộ Công an chủ trì, phối hợp với Bộ trưởng Bộ Quốc phòng, Viện trưởng Viện kiểm sát nhân dân tối cao, Chánh án Tòa án nhân dân tối cao quy định chi tiết khoản này.”.\n14. Bổ sung khoản 3 vào sau khoản 2 Điều 132 như sau:\n“3. Chữ ký của người ban hành văn bản tố tụng là chữ ký trực tiếp hoặc chữ ký số.\nBộ trưởng Bộ Công an chủ trì, phối hợp với Bộ trưởng Bộ Quốc phòng, Viện trưởng Viện kiểm sát nhân dân tối cao, Chánh án Tòa án nhân dân tối cao quy định chi tiết khoản này.”.\n15. Sửa tên Điều và bổ sung khoản 5 vào sau khoản 4 Điều 135 như sau:\na) Sửa tên Điều như sau:\n“Điều 135. Chi phí trong tố tụng hình sự”;\nb) Bổ sung khoản 5 vào sau khoản 4 như sau:\n“5. Ủy ban Thường vụ Quốc hội quy định cụ thể về chi phí tố tụng và việc miễn, giảm chi phí tố tụng trong quá trình giải quyết vụ án.”.\n16. Sửa đổi, bổ sung điểm d khoản 1 Điều 137 như sau:\n“d) Thông báo trên phương tiện thông tin đại chúng, qua nền tảng số, phần mềm ứng dụng dùng chung triển khai tại Trung tâm dữ liệu quốc gia, cổng thông tin hoặc trang thông tin điện tử của cơ quan tiến hành tố tụng.”.\n17. Sửa đổi, bổ sung Điều 141 như sau:\n“Điều 141. Thủ tục thông báo trên phương tiện thông tin đại chúng, qua nền tảng số, phần mềm ứng dụng dùng chung triển khai tại Trung tâm dữ liệu quốc gia, cổng thông tin hoặc trang thông tin điện tử của cơ quan tiến hành tố tụng\n1. Việc thông báo văn bản tố tụng trên phương tiện thông tin đại chúng, qua nền tảng số, phần mềm ứng dụng dùng chung triển khai tại Trung tâm dữ liệu quốc gia, cổng thông tin hoặc trang thông tin điện tử của cơ quan tiến hành tố tụng được thực hiện khi việc niêm yết công khai không có kết quả hoặc các trường hợp khác theo quy định của pháp luật.\n2. Thông báo trên phương tiện thông tin đại chúng được đăng trên báo hàng ngày của trung ương trong 03 số liên tiếp và phát sóng trên Đài Phát thanh hoặc Đài Truyền hình của trung ương ba lần trong 03 ngày liên tiếp.\nThời điểm để tính thời hạn tố tụng là ngày kết thúc việc thông báo.\n3. Bộ trưởng Bộ Công an chủ trì, phối hợp với Bộ trưởng Bộ Quốc phòng, Viện trưởng Viện kiểm sát nhân dân tối cao, Chánh án Tòa án nhân dân tối cao quy định chi tiết Điều này.”.\n18. Sửa đổi, bổ sung khoản 1 Điều 149 như sau:\n“1. Khi lý do tạm đình chỉ việc giải quyết tố giác, tin báo về tội phạm, kiến nghị khởi tố không còn, Cơ quan điều tra, cơ quan được giao nhiệm vụ tiến hành một số hoạt động điều tra, Viện kiểm sát ra quyết định phục hồi giải quyết tố giác, tin báo về tội phạm, kiến nghị khởi tố. Thời hạn giải quyết tố giác, tin báo về tội phạm, kiến nghị khởi tố tiếp không quá 01 tháng kể từ ngày ra quyết định phục hồi.”.\n19. Sửa đổi, bổ sung khoản 2 Điều 150 như sau:\n“2. Tranh chấp về thẩm quyền giải quyết tố giác, tin báo về tội phạm, kiến nghị khởi tố giữa các Cơ quan điều tra quân sự khu vực thuộc các quân khu khác nhau do Viện kiểm sát quân sự cấp quân khu nơi đầu tiên tiếp nhận tố giác, tin báo về tội phạm, kiến nghị khởi tố giải quyết.”.\n20. Sửa đổi, bổ sung điểm a và điểm b khoản 5 Điều 163 như sau:\n“a) Cơ quan điều tra cấp tỉnh điều tra vụ án hình sự về những tội phạm thuộc thẩm quyền xét xử của Tòa án nhân dân cấp tỉnh, Tòa án nhân dân khu vực;\nb) Cơ quan điều tra quân sự khu vực điều tra vụ án hình sự về những tội phạm thuộc thẩm quyền xét xử của Tòa án quân sự khu vực; Cơ quan điều tra quân sự cấp quân khu điều tra vụ án hình sự về những tội phạm thuộc thẩm quyền xét xử của Tòa án quân sự cấp quân khu hoặc những vụ án thuộc thẩm quyền điều tra của Cơ quan điều tra cấp khu vực nếu xét thấy cần trực tiếp điều tra;”.\n21. Sửa đổi, bổ sung một số khoản của Điều 171 như sau:\na) Sửa đổi, bổ sung khoản 1 như sau:\n“1. Khi cần thiết, Cơ quan điều tra ủy thác cho Cơ quan điều tra khác tiến hành một số hoạt động điều tra. Quyết định ủy thác điều tra phải ghi rõ yêu cầu và gửi cho Cơ quan điều tra được ủy thác, Viện kiểm sát có thẩm quyền thực hành quyền công tố, kiểm sát đối với hoạt động điều tra được ủy thác.”;\nb) Sửa đổi, bổ sung khoản 3 như sau:\n“3. Viện kiểm sát có thẩm quyền có trách nhiệm thực hành quyền công tố và kiểm sát đối với hoạt động điều tra được ủy thác và phải chuyển ngay kết quả cho Viện kiểm sát đã ủy thác thực hành quyền công tố và kiểm sát điều tra.”.\n22. Sửa đổi, bổ sung các điểm a, b và c khoản 5 Điều 172 như sau:\n“a) Đối với tội phạm ít nghiêm trọng thì Viện kiểm sát nhân dân khu vực, Viện kiểm sát quân sự khu vực gia hạn điều tra. Trường hợp vụ án do Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu thực hành quyền công tố, kiểm sát điều tra thì Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu gia hạn điều tra;\nb) Đối với tội phạm nghiêm trọng thì Viện kiểm sát nhân dân khu vực, Viện kiểm sát quân sự khu vực gia hạn điều tra lần thứ nhất và lần thứ hai. Trường hợp vụ án do Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu thực hành quyền công tố, kiểm sát điều tra thì Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu gia hạn điều tra lần thứ nhất và lần thứ hai;\nc) Đối với tội phạm rất nghiêm trọng thì Viện kiểm sát nhân dân khu vực, Viện kiểm sát quân sự khu vực gia hạn điều tra lần thứ nhất; Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu gia hạn điều tra lần thứ hai. Trường hợp vụ án do Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu thực hành quyền công tố, kiểm sát điều tra thì Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu gia hạn điều tra lần thứ nhất và lần thứ hai;”.\n23. Sửa đổi, bổ sung điểm a khoản 3 Điều 173 như sau:\n“a) Viện kiểm sát nhân dân khu vực, Viện kiểm sát quân sự khu vực có quyền gia hạn tạm giam đối với tội phạm ít nghiêm trọng, tội phạm nghiêm trọng và tội phạm rất nghiêm trọng. Trường hợp vụ án do Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu thực hành quyền công tố, kiểm sát điều tra thì Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu có quyền gia hạn tạm giam đối với tội phạm ít nghiêm trọng, tội phạm nghiêm trọng, tội phạm rất nghiêm trọng.\nViện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu gia hạn tạm giam lần thứ nhất đối với tội phạm đặc biệt nghiêm trọng;”.\n24. Sửa đổi, bổ sung khoản 2 Điều 193 như sau:\n“2. Trong trường hợp khẩn cấp, những người có thẩm quyền quy định tại khoản 2 Điều 110 của Bộ luật này có quyền ra lệnh khám xét. Trong thời hạn 24 giờ kể từ khi khám xét xong, người ra lệnh khám xét phải thông báo bằng văn bản cho Viện kiểm sát có thẩm quyền.”.\n25. Sửa đổi, bổ sung khoản 2 Điều 208 như sau:\n“2. Thời hạn giám định đối với các trường hợp khác thực hiện theo quy định của Luật Giám định tư pháp.”.\n26. Sửa đổi, bổ sung khoản 1 Điều 225 như sau:\n“1. Thủ trưởng Cơ quan điều tra cấp tỉnh, Thủ trưởng Cơ quan điều tra quân sự cấp quân khu trở lên tự mình hoặc theo yêu cầu của Viện trưởng Viện kiểm sát nhân dân cấp tỉnh, Viện trưởng Viện kiểm sát quân sự cấp quân khu trở lên có quyền ra quyết định áp dụng biện pháp điều tra tố tụng đặc biệt.\nTrường hợp vụ án do Cơ quan điều tra quân sự khu vực thụ lý, điều tra thì Thủ trưởng Cơ quan điều tra quân sự khu vực đề nghị Thủ trưởng Cơ quan điều tra quân sự cấp quân khu xem xét, quyết định áp dụng.”.\n27. Sửa đổi, bổ sung Điều 233 như sau:\n“Điều 233. Kết luận điều tra trong trường hợp đề nghị truy tố\n1. Trong trường hợp đề nghị truy tố thì bản kết luận điều tra ghi rõ diễn biến hành vi phạm tội; chứng cứ xác định hành vi phạm tội của bị can, thủ đoạn, động cơ, mục đích phạm tội, tính chất, mức độ thiệt hại do hành vi phạm tội gây ra; việc áp dụng, thay đổi, hủy bỏ biện pháp ngăn chặn, biện pháp cưỡng chế; tình tiết tăng nặng, giảm nhẹ trách nhiệm hình sự, đặc điểm nhân thân của bị can; việc thu giữ, tạm giữ tài liệu, đồ vật và việc xử lý vật chứng; nguyên nhân và điều kiện dẫn đến hành vi phạm tội và tình tiết khác có ý nghĩa đối với vụ án; lý do và căn cứ đề nghị truy tố; tội danh, điều, khoản, điểm của Bộ luật Hình sự được áp dụng; những ý kiến đề xuất giải quyết vụ án.\nBản kết luận điều tra phải ghi rõ ngày, tháng, năm ra kết luận; họ tên, chức vụ và chữ ký của người ra kết luận điều tra.\n2. Cơ quan điều tra có thể kết luận điều tra đề nghị truy tố bị can khi đã có đủ căn cứ và bảo đảm quyền bào chữa cho bị can theo quy định của Bộ luật này trong các trường hợp sau:\na) Bị can trốn hoặc không biết bị can ở đâu và việc truy nà không có kết quả;\nb) Bị can đang ở nước ngoài mà không thể triệu tập để phục vụ các hoạt động điều tra.\n3. Trong thời hạn 02 ngày kể từ ngày ban hành kết luận điều tra đề nghị truy tố đối với bị can quy định tại khoản 2 Điều này, kết luận điều tra phải được niêm yết nếu không thể giao được cho bị can.\n4. Bộ trưởng Bộ Công an chủ trì, phối hợp với Bộ trưởng Bộ Quốc phòng, Viện trưởng Viện kiểm sát nhân dân tối cao, Chánh án Tòa án nhân dân tối cao quy định chi tiết khoản 2 và khoản 3 Điều này.”.\n28. Sửa đổi, bổ sung khoản 1 Điều 239 như sau:\n“1. Viện kiểm sát có thẩm quyền quyết định việc truy tố là Viện kiểm sát đã thực hành quyền công tố và kiểm sát điều tra. Thẩm quyền truy tố của Viện kiểm sát được xác định theo thẩm quyền xét xử của Tòa án đối với vụ án.\nTrường hợp vụ án không thuộc thẩm quyền truy tố của mình, Viện kiểm sát ra ngay quyết định chuyển vụ án cho Viện kiểm sát có thẩm quyền. Việc chuyển vụ án cho Viện kiểm sát ngoài phạm vi tỉnh, thành phố hoặc ngoài phạm vi quân khu do Viện kiểm sát nhân dân cấp tỉnh, Viện kiểm sát quân sự cấp quân khu quyết định.\nĐối với vụ án do Viện kiểm sát cấp trên thực hành quyền công tố, kiểm sát điều tra thì Viện kiểm sát cấp trên quyết định việc truy tố. Chậm nhất là 02 tháng trước khi kết thúc điều tra, Viện kiểm sát cấp trên phải thông báo cho Viện kiểm sát cấp dưới cùng cấp với Tòa án có thẩm quyền xét xử sơ thẩm vụ án để cử Kiểm sát viên tham gia nghiên cứu hồ sơ vụ án. Ngay sau khi quyết định truy tố, Viện kiểm sát cấp trên ra quyết định phân công cho Viện kiểm sát cấp dưới thực hành quyền công tố, kiểm sát xét xử; sau khi nhận được hồ sơ vụ án kèm theo bản cáo trạng, Viện kiểm sát cấp dưới có thẩm quyền thực hành quyền công tố và kiểm sát xét xử theo đúng quy định của Bộ luật này.”.\n29. Sửa đổi, bổ sung Điều 243 như sau:\n“Điều 243. Quyết định truy tố bị can\n1. Viện kiểm sát quyết định truy tố bị can trước Tòa án bằng bản cáo trạng.\nBản cáo trạng ghi rõ diễn biến hành vi phạm tội; chứng cứ xác định hành vi phạm tội của bị can, thủ đoạn, động cơ, mục đích phạm tội, tính chất, mức độ thiệt hại do hành vi phạm tội gây ra; việc áp dụng, thay đổi, hủy bỏ biện pháp ngăn chặn, biện pháp cưỡng chế; tình tiết tăng nặng, giảm nhẹ trách nhiệm hình sự, đặc điểm nhân thân của bị can; việc thu giữ, tạm giữ tài liệu, đồ vật và việc xử lý vật chứng; nguyên nhân và điều kiện dẫn đến hành vi phạm tội và tình tiết khác có ý nghĩa đối với vụ án.\nPhần kết luận của bản cáo trạng ghi rõ tội danh và điều, khoản, điểm của Bộ luật Hình sự được áp dụng.\nBản cáo trạng phải ghi rõ ngày, tháng, năm ra cáo trạng; họ tên, chức vụ và chữ ký của người ra bản cáo trạng.\n2. Viện kiểm sát có thể quyết định truy tố bị can khi đã có đủ căn cứ và bảo đảm quyền bào chữa cho bị can theo quy định của Bộ luật này trong các trường hợp sau:\na) Bị can trốn hoặc không biết bị can ở đâu và việc truy nà không có kết quả;\nb) Bị can đang ở nước ngoài mà không thể triệu tập để phục vụ các hoạt động nhằm quyết định việc truy tố.\n3. Trong thời hạn 03 ngày kể từ ngày ra bản cáo trạng theo quy định tại khoản 2 Điều này, cáo trạng phải được niêm yết nếu không thể giao được cho bị can.\n4. Viện trưởng Viện kiểm sát nhân dân tối cao chủ trì, phối hợp với Bộ trưởng Bộ Công an, Bộ trưởng Bộ Quốc phòng, Chánh án Tòa án nhân dân tối cao quy định chi tiết khoản 2 và khoản 3 Điều này.”.\n30. Sửa đổi, bổ sung khoản 2 Điều 262 như sau:\n“2. Trong thời hạn 10 ngày kể từ ngày tuyên án hoặc kể từ ngày ra quyết định, Tòa án cấp phúc thẩm phải gửi bản án hoặc quyết định phúc thẩm cho Viện kiểm sát cùng cấp; cơ quan thi hành án hình sự có thẩm quyền; Cơ quan điều tra, Viện kiểm sát, Tòa án nơi đã xét xử sơ thẩm; Trại tạm giam, Trại giam nơi đang giam giữ bị cáo; người đã kháng cáo, người có quyền lợi, nghĩa vụ liên quan đến việc kháng cáo, kháng nghị hoặc người đại diện của họ; cơ quan thi hành án dân sự có thẩm quyền trong trường hợp bản án phúc thẩm có tuyên hình phạt tiền, tịch thu tài sản và quyết định dân sự; thông báo bằng văn bản cho Ủy ban nhân dân cấp xã nơi cư trú hoặc cơ quan, tổ chức nơi làm việc, học tập của bị cáo. Trường hợp Tòa Phúc thẩm Tòa án nhân dân tối cao, Tòa án quân sự trung ương xét xử phúc thẩm thì thời hạn này có thể kéo dài nhưng không quá 25 ngày.”.\n31. Sửa đổi, bổ sung Điều 268 như sau:\n“Điều 268. Thẩm quyền xét xử của Tòa án\n1. Tòa án nhân dân khu vực xét xử sơ thẩm những vụ án hình sự về tội phạm ít nghiêm trọng, tội phạm nghiêm trọng, tội phạm rất nghiêm trọng và tội phạm đặc biệt nghiêm trọng mà mức cao nhất của khung hình phạt do Bộ luật Hình sự quy định đến 20 năm tù.\n2. Tòa án nhân dân cấp tỉnh xét xử sơ thẩm những vụ án:\na) Vụ án hình sự về các tội phạm không thuộc thẩm quyền của Tòa án nhân dân khu vực;\nb) Vụ án hình sự thuộc thẩm quyền xét xử của Tòa án nhân dân khu vực nhưng có nhiều tình tiết phức tạp, liên quan đến nhiều cấp, nhiều ngành, dư luận xã hội đặc biệt quan tâm; vụ án mà khi xử lý có ảnh hưởng đến chính trị, đối ngoại; vụ án mà người phạm tội là cán bộ lãnh đạo chủ chốt từ cấp tỉnh trở lên, người có chức sắc trong tôn giáo hoặc có uy tín cao trong dân tộc thiểu số.\nChánh án Tòa án nhân dân tối cao chủ trì, phối hợp với Viện trưởng Viện kiểm sát nhân dân tối cao quy định chi tiết điểm này.\n3. Tòa án quân sự khu vực xét xử sơ thẩm những vụ án hình sự về tội phạm ít nghiêm trọng, tội phạm nghiêm trọng và tội phạm rất nghiêm trọng, trừ tội phạm, vụ án:\na) Các tội xâm phạm an ninh quốc gia;\nb) Các tội phá hoại hòa bình, chống loài người và tội phạm chiến tranh;\nc) Các tội quy định tại các điều 123, 125, 126, 227, 277, 278, 279, 280, 282, 283, 284, 286, 287, 288, 337, 368, 369, 370, 371, 399 và 400 của Bộ luật Hình sự;\nd) Các tội phạm được thực hiện ở ngoài lãnh thổ nước Cộng hòa xã hội chủ nghĩa Việt Nam;\nđ) Vụ án hình sự có bị cáo, bị hại, đương sự ở nước ngoài hoặc tài sản có liên quan đến vụ án ở nước ngoài.\n4. Tòa án quân sự cấp quân khu xét xử sơ thẩm những vụ án:\na) Vụ án hình sự về các tội phạm không thuộc thẩm quyền của Tòa án quân sự khu vực;\nb) Vụ án hình sự thuộc thẩm quyền xét xử của Tòa án quân sự khu vực nhưng có nhiều tình tiết phức tạp khó đánh giá, thống nhất về tính chất vụ án hoặc liên quan đến nhiều cấp, nhiều ngành; vụ án mà bị cáo là Thẩm phán, Kiểm sát viên, Điều tra viên, cán bộ lãnh đạo chủ chốt từ cấp tỉnh, Trung đoàn trưởng và tương đương trở lên, người có chức sắc trong tôn giáo hoặc có uy tín cao trong dân tộc thiểu số.”.\n32. Sửa đổi, bổ sung khoản 2 Điều 269 như sau:\n“2. Bị cáo phạm tội ở nước ngoài nếu xét xử ở Việt Nam thì Tòa án nhân dân nơi cư trú cuối cùng của bị cáo ở trong nước xét xử theo thẩm quyền. Nếu không xác định được nơi cư trú cuối cùng ở trong nước của bị cáo thì tùy từng trường hợp, Chánh án Tòa án nhân dân tối cao ra quyết định giao cho một Tòa án nhân dân khu vực thuộc Tòa án nhân dân thành phố Hà Nội, thành phố Đà Nẵng hoặc Thành phố Hồ Chí Minh hoặc giao cho Tòa án nhân dân thành phố Hà Nội, thành phố Đà Nẵng hoặc Thành phố Hồ Chí Minh xét xử.\nBị cáo phạm tội ở nước ngoài nếu thuộc thẩm quyền xét xử của Tòa án quân sự thì Tòa án quân sự cấp quân khu xét xử theo quyết định của Chánh án Tòa án quân sự trung ương.”.\n33. Sửa đổi, bổ sung điểm a khoản 2 Điều 290 như sau:\n“a) Bị cáo trốn hoặc không biết bị cáo ở đâu và việc truy nã không có kết quả;”.\n34. Sửa đổi, bổ sung khoản 1 và khoản 2 Điều 344 như sau:\n“1. Tòa án nhân dân cấp tỉnh có thẩm quyền xét xử phúc thẩm bản án, quyết định của Tòa án nhân dân khu vực bị kháng cáo, kháng nghị.\n2. Tòa Phúc thẩm Tòa án nhân dân tối cao có thẩm quyền xét xử phúc thẩm bản án, quyết định của Tòa án nhân dân cấp tỉnh bị kháng cáo, kháng nghị.”.\n35. Sửa đổi, bổ sung khoản 1 và khoản 2 Điều 346 như sau:\n“1. Tòa án nhân dân cấp tỉnh, Tòa án quân sự cấp quân khu phải mở phiên tòa phúc thẩm trong thời hạn 60 ngày kể từ ngày nhận được hồ sơ vụ án; trường hợp xét xử vụ án về tội phạm đặc biệt nghiêm trọng có mức cao nhất của khung hình phạt đến 20 năm tù thì thời hạn mở phiên tòa phúc thẩm là 90 ngày kể từ ngày nhận được hồ sơ vụ án.\nTòa Phúc thẩm Tòa án nhân dân tối cao, Tòa án quân sự trung ương phải mở phiên tòa phúc thẩm trong thời hạn 90 ngày kể từ ngày nhận được hồ sơ vụ án.\n2. Trong thời hạn 45 ngày đối với Tòa án nhân dân cấp tỉnh, Tòa án quân sự cấp quân khu, 75 ngày đối với Tòa Phúc thẩm Tòa án nhân dân tối cao, Tòa án quân sự trung ương kể từ ngày thụ lý vụ án, Thẩm phán chủ tọa phiên tòa phải ra một trong các quyết định:\na) Đình chỉ xét xử phúc thẩm;\nb) Đưa vụ án ra xét xử phúc thẩm.”.\n36. Sửa đổi, bổ sung khoản 1 và khoản 2 Điều 347 như sau:\n“1. Sau khi thụ lý vụ án, Tòa án cấp phúc thẩm có quyền quyết định việc áp dụng, thay đổi, hủy bỏ biện pháp ngăn chặn, biện pháp cưỡng chế.\nViệc áp dụng, thay đổi hoặc hủy bỏ biện pháp tạm giam do Chánh án, Phó Chánh án Tòa án; Thẩm phán giữ chức vụ Chánh tòa, Phó Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao quyết định. Việc áp dụng, thay đổi, hủy bỏ các biện pháp ngăn chặn khác, biện pháp cưỡng chế do Thẩm phán chủ tọa phiên tòa quyết định.\n2. Thời hạn tạm giam để chuẩn bị xét xử không được quá thời hạn chuẩn bị xét xử phúc thẩm quy định tại Điều 346 của Bộ luật này.\nTrường hợp còn thời hạn tạm giam bị cáo mà xét thấy cần phải tiếp tục tạm giam bị cáo thì Tòa án cấp phúc thẩm sử dụng thời hạn tạm giam theo quyết định tạm giam của Tòa án cấp sơ thẩm. Trường hợp đã hết thời hạn tạm giam bị cáo theo quyết định tạm giam của Tòa án cấp sơ thẩm thì Chánh án, Phó Chánh án Tòa án, Thẩm phán giữ chức vụ Chánh tòa, Phó Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao ra quyết định tạm giam mới.\nĐối với bị cáo đang bị tạm giam, nếu xét thấy cần tiếp tục tạm giam để hoàn thành việc xét xử thì Hội đồng xét xử ra quyết định tạm giam cho đến khi kết thúc phiên tòa.”.\n37. Sửa đổi, bổ sung khoản 2 và bổ sung khoản 3 vào sau khoản 2 Điều 352 như sau:\n“2. Thời hạn hoãn phiên tòa phúc thẩm được thực hiện theo quy định tại khoản 2 Điều 297 của Bộ luật này.\n3. Quyết định hoãn phiên tòa phúc thẩm phải được chủ tọa phiên tòa thay mặt Hội đồng xét xử ký tên. Trường hợp chủ tọa phiên tòa vắng mặt hoặc bị thay đổi thì Chánh án Tòa án, Thẩm phán giữ chức vụ Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao ký quyết định hoãn phiên tòa.\nQuyết định hoãn phiên tòa phải thông báo ngay cho những người tham gia tố tụng có mặt tại phiên tòa; gửi cho Viện kiểm sát cùng cấp và những người vắng mặt tại phiên tòa trong thời hạn 02 ngày kể từ ngày ra quyết định.”.\n38. Sửa đổi, bổ sung một số điểm, khoản của Điều 367 như sau:\na) Sửa đổi, bổ sung điểm e khoản 1 như sau:\n“e) Trường hợp người bị kết án có đơn xin ân giảm gửi Chủ tịch nước thì Chánh án Tòa án nhân dân tối cao, Viện trưởng Viện kiểm sát nhân dân tối cao có ý kiến trình Chủ tịch nước về việc xét đơn xin ân giảm. Trường hợp Chủ tịch nước quyết định ân giảm thì Chánh án Tòa án đã xét xử sơ thẩm ra quyết định chuyển hình phạt tử hình thành tù chung thân cho người bị kết án. Hết thời hạn 01 năm kể từ ngày nhận được ý kiến của Chánh án Tòa án nhân dân tối cao, Viện trưởng Viện kiểm sát nhân dân tối cao mà Chủ tịch nước không có quyết định ân giảm thì cơ quan có thẩm quyền thông báo ngay về việc không có quyết định ân giảm của Chủ tịch nước để Chánh án Tòa án đã xét xử sơ thẩm tổ chức việc thi hành bản án tử hình theo quy định.”;\nb) Bổ sung khoản 3 vào sau khoản 2 như sau:\n“3. Chánh án Tòa án nhân dân tối cao chủ trì, phối hợp với Viện trưởng Viện kiểm sát nhân dân tối cao, Bộ trưởng Bộ Công an, Bộ trưởng Bộ Quốc phòng quy định chi tiết Điều này.”.\n39. Sửa đổi, bổ sung khoản 2 Điều 372 như sau:\n“2. Tòa án quân sự cấp quân khu thực hiện việc kiểm tra bản án, quyết định đã có hiệu lực pháp luật của Tòa án quân sự khu vực để phát hiện vi phạm pháp luật và kiến nghị Chánh án Tòa án quân sự trung ương xem xét kháng nghị.”.\n40. Sửa đổi, bổ sung một số khoản của Điều 373 như sau:\na) Sửa đổi, bổ sung khoản 1 như sau:\n“1. Chánh án Tòa án nhân dân tối cao, Viện trưởng Viện kiểm sát nhân dân tối cao có quyền kháng nghị theo thủ tục giám đốc thẩm bản án, quyết định đã có hiệu lực pháp luật của Tòa Phúc thẩm Tòa án nhân dân tối cao, Tòa án nhân dân cấp tỉnh; bản án, quyết định đã có hiệu lực pháp luật của Tòa án khác khi xét thấy cần thiết, trừ quyết định của Hội đồng Thẩm phán Tòa án nhân dân tối cao.”;\nb) Sửa đổi, bổ sung khoản 3 như sau:\n“3. Chánh án Tòa án nhân dân cấp tỉnh, Viện trưởng Viện kiểm sát nhân dân cấp tỉnh có quyền kháng nghị theo thủ tục giám đốc thẩm bản án, quyết định đã có hiệu lực pháp luật của Tòa án nhân dân khu vực trong phạm vi tỉnh, thành phố.”.\n41. Sửa đổi, bổ sung Điều 382 như sau:\n“Điều 382. Thẩm quyền giám đốc thẩm\n1. Hội đồng Thẩm phán Tòa án nhân dân tối cao giám đốc thẩm bằng Hội đồng xét xử gồm năm Thẩm phán đối với bản án, quyết định đã có hiệu lực pháp luật của Tòa Phúc thẩm Tòa án nhân dân tối cao, Tòa án nhân dân cấp tỉnh, Tòa án quân sự trung ương bị kháng nghị.\n2. Hội đồng toàn thể Thẩm phán Tòa án nhân dân tối cao giám đốc thẩm đối với bản án, quyết định đã có hiệu lực pháp luật quy định tại khoản 1 Điều này nhưng có tính chất phức tạp hoặc bản án, quyết định đã được Hội đồng Thẩm phán Tòa án nhân dân tối cao giám đốc thẩm bằng Hội đồng xét xử gồm năm Thẩm phán nhưng không thống nhất khi biểu quyết thông qua quyết định về việc giải quyết vụ án.\nKhi Hội đồng toàn thể Thẩm phán Tòa án nhân dân tối cao xét xử giám đốc thẩm thì phải có ít nhất hai phần ba tổng số thành viên tham gia, do Chánh án Tòa án nhân dân tối cao làm chủ tọa phiên tòa. Quyết định của Hội đồng toàn thể Thẩm phán Tòa án nhân dân tối cao phải được quá nửa tổng số thành viên Hội đồng biểu quyết tán thành; nếu không được quá nửa tổng số thành viên của Hội đồng toàn thể Thẩm phán tán thành thì phải hoãn phiên tòa. Trong thời hạn 30 ngày kể từ ngày ra quyết định hoãn phiên tòa thì Hội đồng toàn thể Thẩm phán phải mở phiên tòa xét xử lại vụ án.\n3. Ủy ban Thẩm phán Tòa án quân sự trung ương giám đốc thẩm đối với bản án, quyết định đã có hiệu lực pháp luật của Tòa án quân sự cấp quân khu, Tòa án quân sự khu vực bị kháng nghị. Khi xét xử giám đốc thẩm thì phải có ít nhất hai phần ba tổng số thành viên của Ủy ban Thẩm phán Tòa án quân sự trung ương tham gia, do Chánh án Tòa án quân sự trung ương làm chủ tọa phiên tòa. Quyết định của Ủy ban Thẩm phán phải được quá nửa tổng số thành viên biểu quyết tán thành; nếu không được quá nửa tổng số thành viên của Ủy ban Thẩm phán tán thành thì phải hoãn phiên tòa. Trong thời hạn 30 ngày kể từ ngày ra quyết định hoãn phiên tòa thì Ủy ban Thẩm phán phải mở phiên tòa xét xử lại vụ án.\n4. Ủy ban Thẩm phán Tòa án nhân dân cấp tỉnh giám đốc thẩm đối với bản án, quyết định đã có hiệu lực pháp luật của Tòa án nhân dân khu vực bị kháng nghị. Khi xét xử giám đốc thẩm thì phải có ít nhất hai phần ba tổng số thành viên của Ủy ban Thẩm phán Tòa án nhân dân cấp tỉnh tham gia, do Chánh án Tòa án nhân dân cấp tỉnh làm chủ tọa phiên tòa. Quyết định của Ủy ban Thẩm phán phải được quá nửa tổng số thành viên biểu quyết tán thành; nếu không được quá nửa tổng số thành viên của Ủy ban Thẩm phán tán thành thì phải hoãn phiên tòa. Trong thời hạn 30 ngày kể từ ngày ra quyết định hoàn phiên tòa thì Ủy ban Thẩm phán phải mở phiên tòa xét xử lại vụ án.\n5. Bản án, quyết định đã có hiệu lực pháp luật bị kháng nghị thuộc thẩm quyền giám đốc thẩm của các cấp khác nhau thì Hội đồng Thẩm phán Tòa án nhân dân tối cao giám đốc thẩm toàn bộ vụ án.”.\n42. Sửa đổi, bổ sung khoản 3 Điều 400 như sau:\n“3. Viện trưởng Viện kiểm sát nhân dân cấp tỉnh có quyền kháng nghị theo thủ tục tái thẩm đối với bản án, quyết định đã có hiệu lực pháp luật của Tòa án nhân dân khu vực thuộc phạm vi tỉnh, thành phố.”.\n43. Sửa đổi, bổ sung khoản 2 và khoản 3 Điều 474 như sau:\n“2. Viện trưởng Viện kiểm sát có trách nhiệm giải quyết khiếu nại quyết định, hành vi tố tụng trong việc giữ người trong trường hợp khẩn cấp, bắt, tạm giữ, tạm giam trong giai đoạn điều tra, truy tố. Cơ quan, người có thẩm quyền trong việc giữ người trong trường hợp khẩn cấp, bắt, tạm giữ, tạm giam phải chuyển ngay cho Viện kiểm sát thực hành quyền công tố và kiểm sát điều tra vụ án, vụ việc khiếu nại của người bị giữ, người bị bắt, người bị tạm giữ, người bị tạm giam trong thời hạn 24 giờ kể từ khi nhận được khiếu nại.\nKhiếu nại đối với quyết định, hành vi tố tụng của Thủ trưởng, Phó Thủ trưởng Cơ quan điều tra, Điều tra viên, Cán bộ điều tra, Kiểm sát viên, Kiểm tra viên, người được giao nhiệm vụ tiến hành một số hoạt động điều tra trong việc giữ người trong trường hợp khẩn cấp, bắt, tạm giữ, tạm giam do Viện trưởng Viện kiểm sát giải quyết.\nKhiếu nại đối với quyết định, hành vi tố tụng của Phó Viện trưởng Viện kiểm sát trong việc bắt, tạm giữ, tạm giam do Viện trưởng Viện kiểm sát giải quyết.\nNếu không đồng ý với quyết định giải quyết khiếu nại của Viện trưởng Viện kiểm sát thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Viện trưởng Viện kiểm sát cấp trên trực tiếp. Trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại, Viện trưởng Viện kiểm sát cấp trên trực tiếp phải xem xét, giải quyết. Quyết định giải quyết của Viện trưởng Viện kiểm sát cấp trên trực tiếp là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Viện trưởng Viện kiểm sát trong việc bắt, tạm giữ, tạm giam do Viện trưởng Viện kiểm sát cấp trên trực tiếp xem xét, giải quyết. Trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại, Viện trưởng Viện kiểm sát cấp trên trực tiếp phải xem xét, giải quyết. Quyết định giải quyết của Viện trưởng Viện kiểm sát cấp trên trực tiếp là quyết định có hiệu lực pháp luật.\n3. Tòa án có trách nhiệm giải quyết khiếu nại quyết định bắt, tạm giam trong giai đoạn xét xử.\nKhiếu nại đối với quyết định, hành vi tố tụng của Phó Chánh án trong việc bắt, tạm giam do Chánh án Tòa án xem xét, giải quyết. Nếu không đồng ý với quyết định giải quyết khiếu nại của Chánh án thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Chánh án Tòa án trên một cấp. Trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại, Chánh án Tòa án trên một cấp phải xem xét, giải quyết. Quyết định giải quyết của Chánh án Tòa án trên một cấp là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Chánh án Tòa án trong việc bắt, tạm giam do Chánh án Tòa án trên một cấp xem xét, giải quyết. Trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại, Chánh án Tòa án trên một cấp phải xem xét, giải quyết. Quyết định giải quyết của Chánh án Tòa án trên một cấp là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Thẩm phán giữ chức vụ Phó Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao trong việc bắt, tạm giam do Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao xem xét, giải quyết. Nếu không đồng ý với quyết định giải quyết khiếu nại của Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Chánh án Tòa án nhân dân tối cao. Trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại, Chánh án Tòa án nhân dân tối cao phải xem xét, giải quyết. Quyết định giải quyết của Chánh án Tòa án nhân dân tối cao là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Thẩm phán giữ chức vụ Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao trong việc bắt, tạm giam do Chánh án Tòa án nhân dân tối cao xem xét, giải quyết. Trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại, Chánh án Tòa án nhân dân tối cao phải xem xét, giải quyết. Quyết định giải quyết của Chánh án Tòa án nhân dân tối cao là quyết định có hiệu lực pháp luật.”.\n44. Sửa đổi, bổ sung khoản 1 Điều 475 như sau:\n“1. Khiếu nại đối với quyết định, hành vi tố tụng của Điều tra viên, Cán bộ điều tra, Phó Thủ trưởng Cơ quan điều tra trừ khiếu nại về việc giữ người trong trường hợp khẩn cấp, bắt, tạm giữ, tạm giam do Thủ trưởng Cơ quan điều tra xem xét, giải quyết trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại. Nếu không đồng ý với quyết định giải quyết của Thủ trưởng Cơ quan điều tra thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Viện trưởng Viện kiểm sát có thẩm quyền. Trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại, Viện trưởng Viện kiểm sát có thẩm quyền phải xem xét, giải quyết. Quyết định giải quyết của Viện trưởng Viện kiểm sát có thẩm quyền là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Thủ trưởng Cơ quan điều tra và các quyết định tố tụng của Cơ quan điều tra đã được Viện kiểm sát phê chuẩn do Viện trưởng Viện kiểm sát có thẩm quyền giải quyết trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại. Nếu không đồng ý với quyết định giải quyết của Viện trưởng Viện kiểm sát có thẩm quyền thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Viện trưởng Viện kiểm sát cấp trên trực tiếp. Trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại, Viện trưởng Viện kiểm sát cấp trên trực tiếp phải xem xét, giải quyết. Quyết định giải quyết của Viện trưởng Viện kiểm sát cấp trên trực tiếp là quyết định có hiệu lực pháp luật.”.\n45. Sửa đổi, bổ sung Điều 476 như sau:\n“Điều 476. Thẩm quyền và thời hạn giải quyết khiếu nại đối với Kiểm sát viên, Kiểm tra viên, Phó Viện trưởng, Viện trưởng Viện kiểm sát, Phó Viện trưởng và Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm Viện kiểm sát nhân dân tối cao\n1. Khiếu nại đối với quyết định, hành vi tố tụng của Kiểm sát viên, Kiểm tra viên, Phó Viện trưởng Viện kiểm sát do Viện trưởng Viện kiểm sát xem xét, giải quyết trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại. Nếu không đồng ý với quyết định giải quyết của Viện trưởng Viện kiểm sát thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Viện kiểm sát cấp trên trực tiếp. Trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại, Viện kiểm sát cấp trên trực tiếp phải xem xét, giải quyết. Quyết định giải quyết của Viện trưởng Viện kiểm sát cấp trên trực tiếp là quyết định có hiệu lực pháp luật.\n2. Khiếu nại đối với quyết định, hành vi tố tụng của Viện trưởng Viện kiểm sát do Viện kiểm sát cấp trên trực tiếp xem xét, giải quyết trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại. Quyết định giải quyết của Viện trưởng Viện kiểm sát cấp trên trực tiếp là quyết định có hiệu lực pháp luật.\n3. Khiếu nại đối với quyết định, hành vi tố tụng của Phó Viện trưởng Viện kiểm sát nhân dân tối cao, Kiểm sát viên và Kiểm tra viên công tác tại Viện kiểm sát nhân dân tối cao, Kiểm sát viên và Kiểm tra viên công tác tại Viện kiểm sát quân sự trung ương, Phó Viện trưởng Viện kiểm sát quân sự trung ương do Viện trưởng Viện kiểm sát nhân dân tối cao, Viện trưởng Viện kiểm sát quân sự trung ương xem xét, giải quyết trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại. Quyết định giải quyết của Viện trưởng Viện kiểm sát nhân dân tối cao, Viện trưởng Viện kiểm sát quân sự trung ương là quyết định có hiệu lực pháp luật.\nTrường hợp khiếu nại đối với quyết định, hành vi tố tụng của Kiểm sát viên, Kiểm tra viên, Phó Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm do Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm xem xét, giải quyết trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại. Nếu không đồng ý với quyết định giải quyết của Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Viện trưởng Viện kiểm sát nhân dân tối cao. Trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại, Viện trưởng Viện kiểm sát nhân dân tối cao phải xem xét, giải quyết. Quyết định giải quyết của Viện trưởng Viện kiểm sát nhân dân tối cao là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Viện trưởng Viện Công tố và Kiểm sát xét xử phúc thẩm do Viện trưởng Viện kiểm sát nhân dân tối cao xem xét, giải quyết trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại. Quyết định giải quyết của Viện trưởng Viện kiểm sát nhân dân tối cao là quyết định có hiệu lực pháp luật.”.\n46. Sửa đổi, bổ sung Điều 477 như sau:\n“Điều 477. Thẩm quyền và thời hạn giải quyết khiếu nại đối với Thẩm phán, Thư ký Tòa án, Thẩm tra viên, Phó Chánh án, Chánh án Tòa án, Phó Chánh tòa, Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao\n1. Khiếu nại đối với quyết định, hành vi tố tụng của Thẩm phán, Thư ký Tòa án, Thẩm tra viên, Phó Chánh án Tòa án nhân dân khu vực, Tòa án quân sự khu vực trước khi mở phiên tòa do Chánh án Tòa án nhân dân khu vực, Chánh án Tòa án quân sự khu vực giải quyết trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại.\nNếu không đồng ý với quyết định giải quyết của Chánh án Tòa án nhân dân khu vực, Chánh án Tòa án quân sự khu vực thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu. Trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại, Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu phải xem xét, giải quyết. Quyết định giải quyết của Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Chánh án Tòa án nhân dân khu vực, Chánh án Tòa án quân sự khu vực trước khi mở phiên tòa do Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu xem xét, giải quyết trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại. Quyết định giải quyết của Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu là quyết định có hiệu lực pháp luật.\n2. Khiếu nại đối với quyết định, hành vi tố tụng của Thẩm phán, Thư ký Tòa án, Thẩm tra viên, Phó Chánh án Tòa án nhân dân cấp tỉnh, Tòa án quân sự cấp quân khu trước khi mở phiên tòa do Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu xem xét, giải quyết trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại. Nếu không đồng ý với quyết định giải quyết của Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Chánh án Tòa án nhân dân tối cao, Chánh án Tòa án quân sự trung ương xem xét, giải quyết trong thời hạn 15 ngày. Quyết định giải quyết của Chánh án Tòa án nhân dân tối cao, Chánh án Tòa án quân sự trung ương là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu do Chánh án Tòa án nhân dân tối cao, Chánh án Tòa án quân sự trung ương xem xét, giải quyết trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại. Quyết định giải quyết của Chánh án Tòa án nhân dân tối cao, Chánh án Tòa án quân sự trung ương là quyết định có hiệu lực pháp luật.\n3. Khiếu nại đối với quyết định, hành vi tố tụng của Thẩm phán Tòa án nhân dân tối cao, Thẩm phán, Thư ký Tòa án, Thẩm tra viên công tác tại Tòa án nhân dân tối cao, Phó Chánh án Tòa án nhân dân tối cao, Thẩm phán, Thư ký Tòa án và Thẩm tra viên công tác tại Tòa án quân sự trung ương, Phó Chánh án Tòa án quân sự trung ương do Chánh án Tòa án nhân dân tối cao, Chánh án Tòa án quân sự trung ương xem xét, giải quyết trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại. Quyết định giải quyết của Chánh án Tòa án nhân dân tối cao, Chánh án Tòa án quân sự trung ương là quyết định có hiệu lực pháp luật.\nTrường hợp khiếu nại đối với quyết định, hành vi tố tụng của Thẩm phán, Thư ký Tòa án, Thẩm tra viên, Phó Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao trước khi mở phiên tòa do Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao xem xét, giải quyết trong thời hạn 07 ngày kể từ ngày nhận được khiếu nại. Nếu không đồng ý với quyết định giải quyết của Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao thì trong thời hạn 03 ngày kể từ ngày nhận được quyết định giải quyết khiếu nại, người khiếu nại có quyền khiếu nại đến Chánh án Tòa án nhân dân tối cao xem xét, giải quyết trong thời hạn 15 ngày. Quyết định giải quyết của Chánh án Tòa án nhân dân tối cao là quyết định có hiệu lực pháp luật.\nKhiếu nại đối với quyết định, hành vi tố tụng của Chánh tòa Tòa Phúc thẩm Tòa án nhân dân tối cao do Chánh án Tòa án nhân dân tối cao xem xét, giải quyết trong thời hạn 15 ngày kể từ ngày nhận được khiếu nại. Quyết định giải quyết của Chánh án Tòa án nhân dân tối cao là quyết định có hiệu lực pháp luật.”.\n47. Sửa đổi, bổ sung khoản 1 Điều 481 như sau:\n“1. Tố cáo hành vi vi phạm pháp luật của người có thẩm quyền tiến hành tố tụng thuộc cơ quan có thẩm quyền tiến hành tố tụng nào thì người đứng đầu cơ quan đó có thẩm quyền giải quyết.\nTrường hợp người bị tố cáo là Thủ trưởng Cơ quan điều tra, Viện trưởng Viện kiểm sát thì Thủ trưởng Cơ quan điều tra, Viện trưởng Viện kiểm sát cấp trên trực tiếp có thẩm quyền giải quyết.\nTrường hợp người bị tố cáo là Chánh án Tòa án nhân dân khu vực, Chánh án Tòa án quân sự khu vực thì Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu có thẩm quyền giải quyết.\nTrường hợp người bị tố cáo là Chánh án Tòa án nhân dân cấp tỉnh, Chánh án Tòa án quân sự cấp quân khu thì Chánh án Tòa án nhân dân tối cao, Chánh án Tòa án quân sự trung ương có thẩm quyền giải quyết.\nTrường hợp người bị tố cáo là Chánh án Tòa án quân sự trung ương thì Chánh án Tòa án nhân dân tối cao có thẩm quyền giải quyết.\nTố cáo hành vi tố tụng của người được giao nhiệm vụ tiến hành một số hoạt động điều tra do Viện kiểm sát thực hành quyền công tố, kiểm sát điều tra có thẩm quyền xem xét, giải quyết.”.\n48. Sửa đổi, bổ sung khoản 1 Điều 483 như sau:\n“1. Viện kiểm sát có thẩm quyền và Viện kiểm sát cấp trên kiểm sát việc giải quyết khiếu nại, tố cáo của Cơ quan điều tra, cơ quan được giao nhiệm vụ tiến hành một số hoạt động điều tra, Tòa án.”.\n49. Sửa đổi, bổ sung điểm a khoản 2 Điều 485 như sau:\n“a) Thủ trưởng, Phó Thủ trưởng Cơ quan điều tra của Công an nhân dân, Điều tra viên thuộc trường hợp quy định tại khoản 1a Điều 37 của Bộ luật này có thẩm quyền ra quyết định áp dụng biện pháp bảo vệ đối với người được bảo vệ trong các vụ việc, vụ án hình sự do cơ quan mình thụ lý, giải quyết, điều tra hoặc theo đề nghị của Viện kiểm sát nhân dân, Tòa án nhân dân có thẩm quyền, đề nghị của Viện kiểm sát nhân dân tối cao;”.\n50. Sửa đổi, bổ sung khoản 3 Điều 487 như sau:\n“3. Khi tiến hành tố tụng đối với vụ việc, vụ án, cơ quan được giao nhiệm vụ tiến hành một số hoạt động điều tra, Viện kiểm sát, Tòa án nhận được đề nghị, yêu cầu áp dụng biện pháp bảo vệ có trách nhiệm xem xét, đề nghị Cơ quan điều tra cùng cấp xem xét, quyết định áp dụng biện pháp bảo vệ. Trường hợp Viện kiểm sát nhân dân khu vực, Tòa án nhân dân khu vực nhận được đề nghị, yêu cầu bảo vệ thì đề nghị Cơ quan điều tra cấp tỉnh xem xét, quyết định áp dụng biện pháp bảo vệ.”.\n51. Sửa đổi, bổ sung một số khoản của Điều 501 như sau:\na) Sửa đổi, bổ sung khoản 1 như sau:\n“1. Trong thời hạn 30 ngày kể từ ngày nhận được yêu cầu của cơ quan có thẩm quyền của nước ngoài về việc thi hành bản án, quyết định hình sự của Tòa án nước ngoài đối với công dân Việt Nam bị từ chối dẫn độ, Tòa án nhân dân khu vực đã ra quyết định từ chối dẫn độ xem xét yêu cầu của nước ngoài.”;\nb) Sửa đổi, bổ sung các khoản 5, 6 và 7 như sau:\n“5. Chậm nhất là 10 ngày kể từ ngày ra quyết định cho thi hành hoặc không cho thi hành bản án, quyết định hình sự của Tòa án nước ngoài, Tòa án nhân dân khu vực gửi quyết định cho người bị yêu cầu thi hành, Viện kiểm sát nhân dân cùng cấp, Bộ Công an để thực hiện.\nNgười bị yêu cầu thi hành bản án, quyết định hình sự của Tòa án nước ngoài có quyền kháng cáo, Viện kiểm sát nhân dân cùng cấp có quyền kháng nghị trong thời hạn 15 ngày, Viện kiểm sát nhân dân cấp tỉnh có quyền kháng nghị trong thời hạn 30 ngày kể từ ngày Tòa án nhân dân khu vực ra quyết định.\nTòa án nhân dân khu vực phải gửi hồ sơ và kháng cáo, kháng nghị cho Tòa án nhân dân cấp tỉnh trong thời hạn 07 ngày kể từ ngày hết thời hạn kháng cáo, kháng nghị.\n6. Trong thời hạn 20 ngày kể từ ngày nhận được hồ sơ xem xét yêu cầu thi hành bản án, quyết định hình sự của Tòa án nước ngoài có kháng cáo, kháng nghị, Tòa án nhân dân cấp tỉnh mở phiên họp xem xét quyết định của Tòa án nhân dân khu vực bị kháng cáo, kháng nghị.\nThủ tục xem xét kháng cáo, kháng nghị đối với quyết định của Tòa án nhân dân khu vực được thực hiện theo quy định tại Điều này.\n7. Quyết định thi hành bản án, quyết định hình sự của Tòa án nước ngoài đối với công dân Việt Nam tại Việt Nam có hiệu lực pháp luật gồm:\na) Quyết định của Tòa án nhân dân khu vực không bị kháng cáo, kháng nghị;\nb) Quyết định của Tòa án nhân dân cấp tỉnh.”.\n52. Sửa đổi, bổ sung khoản 3 Điều 502 như sau:\n“3. Chánh án, Phó Chánh án Tòa án nhân dân khu vực, Chánh án, Phó Chánh án Tòa án nhân dân cấp tỉnh quyết định việc áp dụng các biện pháp ngăn chặn quy định tại khoản 1 Điều này. Thẩm phán chủ tọa phiên họp xem xét yêu cầu dẫn độ có quyền quyết định việc áp dụng biện pháp cấm đi khỏi nơi cư trú, biện pháp đặt tiền để bảo đảm sự có mặt của người bị yêu cầu dẫn độ tại phiên họp.”.\n53. Sửa đổi, bổ sung khoản 2 Điều 503 như sau:\n“2. Thời hạn tạm giam để xem xét yêu cầu dẫn độ không quá thời hạn trong lệnh bắt giam của cơ quan có thẩm quyền của nước yêu cầu dẫn độ hoặc thời hạn phải thi hành hoặc còn phải thi hành hình phạt tù trong bản án, quyết định hình sự của Tòa án nước yêu cầu dẫn độ.\nTrường hợp cần thiết, Tòa án nhân dân khu vực, Tòa án nhân dân cấp tỉnh có thể gửi văn bản yêu cầu cơ quan có thẩm quyền của nước yêu cầu dẫn độ ra lệnh, quyết định tạm giam hoặc gia hạn tạm giam người bị yêu cầu dẫn độ để bảo đảm việc xem xét yêu cầu dẫn độ; văn bản yêu cầu được gửi thông qua Bộ Công an.”.\n54. Bổ sung Điều 506a vào sau Điều 506 như sau:\n“Điều 506a. Giữ người trong trường hợp khẩn cấp trước khi có yêu cầu dẫn độ\nViệc giữ người trong trường hợp khẩn cấp trước khi có yêu cầu dẫn độ của cơ quan có thẩm quyền của nước ngoài được thực hiện theo quy định của điều ước quốc tế mà Cộng hòa xã hội chủ nghĩa Việt Nam là thành viên và pháp luật về dẫn độ.”.\n55. Bổ sung cụm từ “, Trưởng phân trại thuộc trại tạm giam” vào sau cụm từ “Trưởng Nhà tạm giữ” tại khoản 2 Điều 134, khoản 1 Điều 332 và khoản 3 Điều 333; bổ sung cụm từ “hoặc có đủ khả năng nhận thức, đủ khả năng điều khiển hành vi” vào sau cụm từ “đã khỏi bệnh” tại khoản 2 Điều 454.\n56. Thay thế cụm từ “Công an xã, phường, thị trấn” bằng cụm từ “Công an cấp xã” tại khoản 3 Điều 111, khoản 3 Điều 112 và khoản 3 Điều 146.\n57. Thay thế cụm từ “Viện kiểm sát cùng cấp” bằng cụm từ “Viện kiểm sát có thẩm quyền” tại khoản 2 Điều 114, khoản 5 Điều 119, khoản 4 Điều 121, khoản 3 Điều 122, khoản 2 Điều 124, khoản 2 và khoản 4 Điều 128, khoản 2 và khoản 4 Điều 129, khoản 3 Điều 152, khoản 1 Điều 169, khoản 3 Điều 170, khoản 3 Điều 179, khoản 3 Điều 180, khoản 1 Điều 189, khoản 1 Điều 190, khoản 1 Điều 191, khoản 3 Điều 193, khoản 1 và khoản 2 Điều 197, khoản 2 Điều 198, khoản 2 Điều 201, khoản 1 Điều 202, khoản 2 Điều 204, khoản 3 Điều 229, khoản 2 và khoản 3 Điều 231, khoản 4 Điều 232, Điều 235, Điều 439, khoản 1 Điều 449 và khoản 2 Điều 457.\n58. Thay thế cụm từ “Viện kiểm sát nhân dân cấp cao” bằng cụm từ “Viện kiểm sát nhân dân tối cao” tại khoản 1 Điều 341.\n59. Thay thế cụm từ “chính quyền xã, phường, thị trấn” bằng cụm từ “Ủy ban nhân dân cấp xã” tại khoản 2 Điều 113, Điều 116, khoản 6 Điều 119, khoản 1 Điều 120, khoản 2 Điều 121, khoản 5 và khoản 6 Điều 123, khoản 4 Điều 128, khoản 2 và khoản 3 Điều 138, khoản 2 Điều 182, điểm a khoản 3 Điều 185, các khoản 1, 2 và 3 Điều 195, khoản 1 Điều 198, khoản 4 Điều 202, khoản 1 Điều 262, khoản 8 Điều 368, khoản 2 Điều 369, khoản 2 Điều 395, điểm b khoản 3 Điều 437 và khoản 2 Điều 440.\n60. Thay thế cụm từ “chính quyền địa phương” bằng cụm từ “Ủy ban nhân dân” tại điểm c khoản 1 Điều 90.\n61. Thay thế cụm từ “Ủy ban nhân dân xã, phường, thị trấn” bằng cụm từ “Ủy ban nhân dân cấp xã” tại khoản 2 Điều 140, khoản 1 Điều 262, khoản 1 Điều 286.\n62. Thay thế cụm từ “Tòa án nhân dân cấp huyện” bằng cụm từ “Tòa án nhân dân khu vực” tại khoản 1 và khoản 2 Điều 275; thay thế cụm từ “Tòa án nhân dân cấp tỉnh” bằng cụm từ “Tòa án nhân dân khu vực” tại khoản 1 và khoản 2 Điều 452.\n63. Thay thế cụm từ “khỏi bệnh” bằng cụm từ “có kết luận khỏi bệnh hoặc có kết luận đủ khả năng nhận thức, đủ khả năng điều khiển hành vi” tại khoản 1 Điều 290, khoản 2 Điều 452; thay thế cụm từ “cơ sở bắt buộc chữa bệnh tâm thần” bằng cụm từ “cơ sở khám bệnh, chữa bệnh” tại khoản 1 và khoản 2 Điều 454; thay thế cụm từ “cơ sở bắt buộc chữa bệnh” bằng cụm từ “cơ sở khám bệnh, chữa bệnh” tại khoản 3 Điều 454.\n64. Thay thế cụm từ “cơ quan thi hành án hình sự Công an cấp huyện” bằng cụm từ “cơ quan thi hành án hình sự Công an cấp tỉnh” tại khoản 3 Điều 364, các khoản 8, 9 và 10 Điều 368.\n65. Thay thế cụm từ “Ủy ban Tư pháp của Quốc hội” bằng cụm từ “Ủy ban Pháp luật và Tư pháp của Quốc hội” tại khoản 1 và khoản 3 Điều 404, khoản 1 và khoản 2 Điều 405, Điều 406, các khoản 2, 3 và 5 Điều 407, Điều 408, điểm a khoản 2 Điều 411 và Điều 412.\n66. Thay thế cụm từ “cấp cao” bằng cụm từ “cấp tỉnh” tại khoản 2 và khoản 3 Điều 380.\n67. Thay thế cụm từ “Cơ quan điều tra cùng cấp” bằng cụm từ “Cơ quan điều tra có thẩm quyền” tại khoản 1 Điều 262.\n68. Thay thế cụm từ “thành phố trực thuộc Trung ương” bằng cụm từ “thành phố” tại các điểm b, đ và h khoản 2 Điều 4, điểm c khoản 5 Điều 163, khoản 2 Điều 169, khoản 1 Điều 274, khoản 1 và khoản 2 Điều 275.\n69. Bỏ cụm từ “Viện kiểm sát cùng cấp hoặc” tại khoản 4 Điều 117, khoản 2 Điều 118, khoản 5 Điều 146, đoạn 2 khoản 2 Điều 147, khoản 2 Điều 148, khoản 2 Điều 149, khoản 2 Điều 156 và khoản 1 Điều 158.\n70. Bỏ cụm từ “Viện trưởng Viện kiểm sát cùng cấp hoặc” tại đoạn 1 khoản 2 Điều 147 và khoản 4 Điều 481.\nĐiều 2. Hiệu lực thi hành\nLuật này có hiệu lực thi hành từ ngày 01 tháng 7 năm 2025.\nLuật này được Quốc hội nước Cộng hòa xã hội chủ nghĩa Việt Nam khóa XV, kỳ họp thứ 9 thông qua ngày 27 tháng 6 năm 2025.\n \n|   | CHỦ TỊCH QUỐC HỘI<br><br><br><br><br>Trần Thanh Mẫn |\n| --- | --- |\n\n \n "
# main(text)

app = FastAPI(title="Legal Amendment Parser")

class ParseRequest(BaseModel):
    text: str

class ParseResponse(BaseModel):
    original: str | None
    addon: list

@app.post("/parse-amendment", response_model=ParseResponse)
def parse_amendment(req: ParseRequest):
    result = process_amendment_document(req.text)
    return result